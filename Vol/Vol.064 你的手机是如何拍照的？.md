# Vol.064 你的手机是如何拍照的？

当你打开手机，准备拍照，镜头会首先把被摄景物投影在图像传感器上，与此同时，影像处理器会通过测光、测距，算出合适的参数并指示镜头对焦。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vCZ5DLjwRbXM9IU83RmE1NA4bCiaPp7EX35v5JcUibb2TLxmf5spexd1g.gif)

随着你按下拍摄键，图像传感器就会完成一次曝光，并通过影像处理器变成图片，再经手机应用的后期处理，最终呈现在屏幕上。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vsqqX1v5gxgWGyERjpQAicoWXrOEibT0UGhNdx7zqLrBe2ib5tam7SN8gQ.gif)

而这其中的每一步，都关系到这张照片的画质，尤其在光线昏暗的夜晚。

拍照，最基本的是视角。这是凸透镜的成像原理，一个物体由无数个点光源组成，单个点光源从各个方向发出光线经透镜折射后，都将汇聚在一点上，最终所有点光源都投射在一个平面上，也就是图像传感器的位置，形成清晰的倒像，而这个角度就是视角。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vibDEkEY972aibAa8jj1gAiczibzXBm0hgOddhicR5xFicqZkEPby3SbUTuhA.gif)

其中，平行光经透镜折射后将汇聚在焦点上，焦点到透镜的距离称为焦距，而物体和传感器到透镜的距离称为物距和像距，三者的关系满足高斯公式。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vmyYCjjLwT0rKHveXbWHVmZX9O7s0Lj9fBIdJkxDEABSuNTMheFW3BA.gif)

可以看出，当焦距越长，或传感器越小，视角就越窄。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vNSMKUJA9d3bJKWOncNoY8e9zwykdZQMCib33LGgZPvOuqW69IrWQZTQ.gif)

受尺寸限制，手机镜头的像距很短，所以物理焦距也必须非常短，通常在 4mm 左右，远小于单反相机标准镜头 35-50mm 的焦距。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0viagDMgbdaHRRswWia3N16ByXskVTDWMMibagtNJibtkYc40uhxLeALDzKQ.gif)

不过，手机的图像传感器也很小，配合短焦镜头，视角正好与标准镜头类似。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vLdauIBL28DYEjOSG5MUS96ZzDRCCDe4T4Ons3OWNxqWEj5j3atfR2A.gif)

选好视角，好看的照片还要靠曝光，主要由光圈值、快门速度和感光度决定。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0v4iaTeHUJFzgwO3MDmkpiawDiaWZl4ylQb62T5F366llKTf6qYicykiaZQMA.gif)

光圈是镜头上用于控制通光量的结构，相当于人眼的瞳孔。镜头焦距越长，视角越窄，入射的光线也就越少，需要更大的光圈直径以获得更多的光。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0v5rPuNdBqfo9qmkkas5AQMA5MCIDPVFJccTlfVJXHjiciclNQ5V7BEic1Q.gif)

所以，光圈值被设定为焦距的分数，称为光圈 f 值。对于单反相机镜头，光圈值 f/2.8 ，即光圈直径是焦距的 1/2.8 ，就算大光圈了。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vRrRPKM88QLG1dzb74Cpm8sEoRO27yiaPicNsxBJC8A2EojmqHgcR53Tg.gif)

而手机镜头由于焦距短，一般最大光圈可达 f/2.0 ，OPPO Reno 系列使用的 IMX 586 甚至达到了 f/1.7 。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0v9JrXgNwFh9h7icIpcjTfw7D5BibHWgdKYGhQu00WYQUxmZESgMV5IfiaQ.gif)

f 值越小，就能给图像传感器投射越多的光，提高成像质量，这对于夜间拍摄尤其重要。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vd5sER3ppbHcKpTnQp0DFhGJjicNkCic6qFY9I4tFFnkdt7tvWmMO0LxA.gif)

除了大光圈，夜间拍摄还要尽可能放慢快门，延长曝光，但这样一来，手持拍摄的抖动就成了大问题。而长焦镜头对抖动更加敏感。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vP9rXbJb1micq9b977yJQu8CibQDLaZ6qQiahURhBCywvjia2xFaUH9LG0A.gif)

于是，OPPO 在 Reno 10 倍变焦版里加入了棱镜光学防抖，利用两个以上的压电传感器获取抖动的加速度信息，然后通过长焦镜头内一枚棱镜的移动来补偿抖动产生的影像错位。

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

当然，影响成像质量最核心的还是图像传感器。

这是一块 CMOS 图像传感器，上面排列着上千万的像素，每个像素里的光电二极管在遇到光时，就会因为光电效应积累一定数量的电荷，将光信号转为电信号。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vHicNxKFOgdjGoJUF9Sgc9nHRE5r986GOjrWNSiao2XhZRvkNUNH9c2PQ.gif)

由于光电二极管无法识别颜色，所以不同像素上还要覆盖红绿蓝三种滤色片，按 1:2:1 的比例设置，以模仿对绿光敏感的人眼，这称为拜尔阵列，能分别识别三原色。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vyAVTEeDvuqpwStqn4M0MkicvzWmLQicd9R2hmEicsZ8s7jxgKnUuWhQeA.gif)

此外，每个像素周围都有专门的放大电路，能把转化出来的电信号不同倍率地放大，可以理解为相机的感光度。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vZVySHkbV1uN2icZvnCbAwyV9iaMDI948Ylia9Tuoh4DDxw7W3CrmiaOMNA.gif)

感光度越高，相机对光线越敏感，照片也越亮，但噪点也会越多。这是因为每个像素都会因为电路干扰产生固定的噪音信号，在高感光度下，噪音信号也会被放大，出现噪点。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vlZXGQq6hekZibVeO0Bv6672F29kxZdFas7ETTxJGZLPDGr1Tg9uEzcg.gif)

噪点问题可以通过增大像素面积来缓解。在有噪音信号的情况下，大像素可以收集更多有用的光信号，增加信噪比，从而减少噪点。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vn2da0vKbTjfLCFgh3ZAuE50UquQeXuhQiaEdkanPo05QpZgGSeMYEDw.gif)

手机使用的主流传感器一般在 1/2.9 到 1/2.3 英寸之间，而 OPPO Reno 等机型，就使用了更大的 1/2 英寸传感器。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vicPmBTL3jGOn3tvWaEUIxiaHibpT5Cg6hAialZxIswxW2QsiaN0pbia1Oickg.gif)

Reno 的传感器还使用了像素聚合技术，通过改变滤色片的排列方式，在光线充足时使用单像素曝光，而在光线不足时就将四个像素拼成一个，四倍的像素面积，带来更加纯净的夜景照片。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0v8xd8zS3cpy5HtIPNbhX4lkiaRoFyKdCNwmtGJR6lI0V3ZxPsPvHdLng.gif)

需要注意，图像传感器上的信息输出后，是拜尔式排列的 RGB 点阵，必须再经过 ISP 图像信号处理器转化为我们常见的点阵图片。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vF5qoShGibrth4zrNStOP2DDtQuem99fgGicoGhN4RetwjR3jgfkfZm5w.gif)

而近年流行的多摄像头，如加装黑白摄像头以保留更多暗部光线信息；或用景深摄像头拍摄多张对焦距离不同的照片，记录景深信息，就需要多个 ISP 。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vjWE0GHlqP1W0o67UfL8SXQia8uQSx4kPul30SmEpMiccDeQvmliabjSvA.gif)

然而，手机镜头毕竟太小，图像传感器的宽容度有限，无法同时覆盖太高和太低的亮度范围。在夜间拍摄时往往高光部分一片全白，而暗部漆黑一片，还有噪点。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vfD4dMZ1zm9JJLiaVjn1DuGOdCRYv8eCW0T8xonr3f5Wkiag1icGcTRPicQ.gif)

这就要靠手机应用的后期力量了。

比如 HDR 高动态范围成像，用不同的曝光水平拍摄多张照片，再将这批照片中细节最好的部分合成为一张照片，让夜景照片也能拥有更多细节。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vvlicX2WUFQUj01VBK8xLib7mzicMGWQIRiaYZVxPZcSRQBYxw7Z8KAzZ5w.gif)

而在 Reno 上，OPPO 的超清夜景 2.0 还实现了对夜景人像的专门优化，将人和周围的景物分别处理，避免出现脸色惨白的情况，还原真实的人脸肤色。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0vTnk6lvJ0Zk4WGiabgmGYh6ORxg4bGSZRdByKrZcD7xDMYqLhc05QlFg.gif)

同时，OPPO 还改进了超清夜景模式算法，将拍摄的等待时间从 4-5 秒降低到 2-3 秒。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0v2ZhwOIBdxVISib7Og7gvnBxSuXBnSnf50Laoum80qeXDfZfVhA0opzw.gif)

在这些技术的加持下，即便是贞子，也能在夜间拍摄时重获少女心。

![img](https://cdn.jsdelivr.net/gh/paperclipcn/static/U6yRaDu1NaYEhv6srreTIlj4PgsYHY0v34faLEQDR9pn9ibib0rmQM7BvibtdNhuoCYywt0Km6fBOpMicQyUiadlLFQ.gif)

!!! note "该文件编辑日志"

	* 	Mar 29, 2020.
		By [parozhao](https://github.com/parozhao)
	
			创建文件 & Markdown 格式化
